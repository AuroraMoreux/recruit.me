@model RecruitMe.Web.ViewModels.JobOffers.EditViewModel
@{
    ViewData["Title"] = @$"Edit Job Offer details for ""{Model.JobOfferDetails.Title}""";

    var jobSectors = Model.JobSectors.Select(js => new SelectListItem(js.Name, js.Id.ToString()));
    var jobLevels = Model.JobLevels.Select(jl => new SelectListItem(jl.Name, jl.Id.ToString()));
    var jobTypes = Model.JobTypesOptions.Select(jt => new SelectListItem(jt.Name, jt.Id.ToString())).ToList();
    var languages = Model.Languages.Select(l => new SelectListItem(l.Name, l.Id.ToString())).ToList();
    var skills = Model.Skills.Select(s => new SelectListItem(s.Name, s.Id.ToString())).ToList();
}

<h1>@ViewData["Title"]</h1>

<script src="/lib/tinymce/tinymce.min.js" type="text/javascript"></script>
<script type="text/javascript">
    tinymce.init({
        selector: "textarea",
        plugins: [
            "image paste table link code media"
        ]
    });
</script>

<div class="container-fluid">
    <form id="inputForm" class="container" asp-controller="JobOffers" asp-action="Edit" method="post">
        <div asp-validation-summary="All" class="text-danger"></div>
        <div>
            <div>
                <div class="form-group">
                    <input hidden asp-for="JobOfferDetails.Id" class="form-control" value="@Model.JobOfferDetails.Id" />
                    <label asp-for="JobOfferDetails.Title"></label>
                    <input asp-for="JobOfferDetails.Title" class="form-control" />
                    <span asp-validation-for="JobOfferDetails.Title" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <label asp-for="JobOfferDetails.Description"></label>
                    <textarea asp-for="JobOfferDetails.Description" class="form-control"></textarea>
                    <span asp-validation-for="JobOfferDetails.Description" class="text-danger"></span>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-6">
                <div class="form-group">
                    <label asp-for="JobOfferDetails.City"></label>
                    <input asp-for="JobOfferDetails.City" class="form-control" />
                    <span asp-validation-for="JobOfferDetails.City" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <label asp-for="JobOfferDetails.OfficeAddress"></label>
                    <input asp-for="JobOfferDetails.OfficeAddress" class="form-control" />
                    <span asp-validation-for="JobOfferDetails.OfficeAddress" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <label asp-for="JobOfferDetails.Salary"></label>
                    <input asp-for="JobOfferDetails.Salary" class="form-control" />
                    <span asp-validation-for="JobOfferDetails.Salary" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <label asp-for="JobOfferDetails.JobSectorId"></label>
                    <select asp-for="JobOfferDetails.JobSectorId" asp-items="jobSectors" class="form-control"></select>
                    <span asp-validation-for="JobOfferDetails.JobSectorId" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <label asp-for="JobOfferDetails.JobLevelId"></label>
                    <select asp-for="JobOfferDetails.JobLevelId" asp-items="jobLevels" class="form-control"></select>
                    <span asp-validation-for="JobOfferDetails.JobLevelId" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="JobOfferDetails.ValidFrom"></label>
                    <input id="ValidFrom" type="date" readonly="@DateTime.UtcNow.Date.ToString("dd-MM-yyyy")" asp-for="JobOfferDetails.ValidFrom" class="form-control" />
                    <span asp-validation-for="JobOfferDetails.ValidFrom" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <label asp-for="JobOfferDetails.ValidUntil"></label>
                    <input id="ValidTo" type="date" readonly="@DateTime.UtcNow.Date.ToString("dd-MM-yyyy")" asp-for="JobOfferDetails.ValidUntil" class="form-control" />
                    <span asp-validation-for="JobOfferDetails.ValidUntil" class="text-danger"></span>
                </div>
                <input type="submit" value="Update Details" class="btn btn-primary" />
            </div>
            <div class="col-6">
                <div class="form-group">
                    <label asp-for="JobOfferDetails.SkillsIds"></label>
                    <select multiple size="7" asp-for="JobOfferDetails.SkillsIds" asp-items="skills" class="form-control"></select>
                    <span asp-validation-for="JobOfferDetails.SkillsIds" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="JobOfferDetails.LanguagesIds"></label>
                    <select multiple size="7" asp-for="JobOfferDetails.LanguagesIds" asp-items="languages" class="form-control"></select>
                    <span asp-validation-for="JobOfferDetails.LanguagesIds" class="text-danger"></span>
                </div>
                <div class="row">
                    <div class="form-group col-6" id="jobTypes">
                        <label asp-for="JobTypesOptions"></label>
                        <ul>
                            @for (int i = 0; i < jobTypes.Count(); i++)
                            {
                                string shouldBeCheckedClass = string.Empty;
                                if (Model.JobOfferDetails.JobTypesIds.Contains(int.Parse(jobTypes[i].Value)))
                                {
                                    shouldBeCheckedClass = "checkedCheckbox";
                                }
                                <li>
                                    <input class="@shouldBeCheckedClass" type="checkbox" asp-for="JobTypesOptions[i].Selected" />
                                    <label asp-for="JobTypesOptions[i].Selected">@Model.JobTypesOptions[i].Name</label>
                                    <input type="hidden" asp-for="JobTypesOptions[i].Id" />
                                    <input type="hidden" asp-for="JobTypesOptions[i].Name" />
                                </li>
                            }
                            <span asp-validation-for="JobTypesOptions" class="text-danger"></span>
                        </ul>
                    </div>
                    <div class="col-6">
                        <div class="form-group">
                            <label>Job Options</label>
                            <br />
                            <ul>
                                <li>
                                    <input type="checkbox" asp-for="JobOfferDetails.IsFullTime" />
                                    <label asp-for="JobOfferDetails.IsFullTime"></label>
                                    <span asp-validation-for="JobOfferDetails.IsFullTime" class="text-danger"></span>
                                </li>
                                <li>
                                    <input type="checkbox" asp-for="JobOfferDetails.IsRemote" />
                                    <label asp-for="JobOfferDetails.IsRemote"></label>
                                    <span asp-validation-for="JobOfferDetails.IsRemote" class="text-danger"></span>
                                </li>
                            </ul>

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <hr />
    </form>
</div>
@section Scripts{
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            $('.checkedCheckbox').prop('checked', true);
        });
    </script>
}